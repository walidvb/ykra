<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<title>Searching for flamingos</title>
	<script src="jquery.min.js"></script>
	<script src="scripts.js"></script>
	<meta content="width=device-width, initial-scale=1.0, user-scalable=no, maximum-scale=1" name="viewport">

	<link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
	<link rel="icon" href="/favicon.ico" type="image/x-icon">
	<link rel="stylesheet" href="styles.css">

	<script>
		// Generated by CoffeeScript 1.6.2
(function() {
  var shuffleArray;

  $(function() {
    var currentSlide, init, myImage, nextSlide, timer;

    window.imgs = [];
    currentSlide = 0;
    timer = null;
    myImage = function(item, index) {
      var $this, self;

      $this = item;
      self = {};
      self.elem = item;
      self.big = $this.attr('data-big');
      self.small = $this.attr('data-small');
      self.load = function(size) {
        var img, src;

        if (size == null) {
          size = 'big';
        }
        console.log(self.loaded);
        src = size === 'big' ? self.big : self.small;
        img = new Image();
        img.src = src;
        console.log('Started fetching ' + src);
        img.onload = function() {
          self.elem.css('backgroundImage', "url('" + src + "')");
          return self.loaded = true;
        };
        return setTimeout(function() {
          return self.loadNext();
        }, 2000);
      };
      self.loaded = false;
      self.show = function(callback) {
        if (callback == null) {
          callback = null;
        }
        timer = setTimeout(function() {
          return $this.show();
        }, 500);
        self.loadNext();
        if (callback !== null) {
          return callback();
        }
      };
      self.hide = function(callback) {
        if (callback == null) {
          callback = null;
        }
        $this.hide();
        clearTimeout(timer);
        if (callback !== null) {
          return callback();
        }
      };
      self.init = function() {
        return $this.click(function() {
          return nextSlide();
        });
      };
      self.index = index;
      self.loadNext = function() {
        var nextIndex, nextSlide;

        nextIndex = currentSlide + 1 >= imgs.length ? 0 : currentSlide + 1;
        nextSlide = imgs[nextIndex];
        if (!nextSlide.loaded) {
          return nextSlide.load();
        }
      };
      return self;
    };
    nextSlide = function() {
      imgs[currentSlide].hide();
      currentSlide = currentSlide + 1 >= imgs.length ? 0 : currentSlide + 1;
      return imgs[currentSlide].show();
    };
    init = function() {
      var all, lastSlide;

      all = shuffleArray($('.img-container'));
      lastSlide = all[all.length];
      all.each(function(index) {
        var i;

        i = new myImage($(this), index);
        i.init();
        return imgs.push(i);
      });
      imgs[0].load();
      return imgs[0].show();
    };
    init();
    return $('.info-trigger').click(function() {
      return $('.info').toggleClass('open');
    });
  });

  /*
  Randomize array element order in-place.
  Using Fisher-Yates shuffle algorithm.
  */


  shuffleArray = function(array) {
    var i, j, temp;

    i = array.length - 1;
    while (i > 0) {
      j = Math.floor(Math.random() * (i + 1));
      temp = array[i];
      array[i] = array[j];
      array[j] = temp;
      i--;
    }
    return array;
  };

}).call(this);

/*
//@ sourceMappingURL=scripts.map
*/

	</script>
</head>
<body>
	
	<div class="images">
		<div class="img-container" data-big="hiRes/egg.jpg", data-small=""></div>
		<div class="img-container" data-big="hiRes/flamingos.jpg", data-small=""></div>
		<div class="img-container" data-big="hiRes/pend.jpg", data-small=""></div>
	</div>
	<div class="info">
		<div class="info-details">
				Scénographie du Lieu central du festival de la Bâtie 2014
				<br><br>
				réalisée par
				<br><br>
				YKRA <br>
				Youri Kravtchenko <br>
				Architecte EPFL-SIA <br>
				9, place des Augustins <br>
				1205 Genève <br>
				<a href="tel:+41787170899">078 717 08 99</a>
				<br><br>
				<a href="mailto:y@ykra.ch", target="_blank">y@ykra.ch</a>
				<br><br>
				Photos : Maria Trofimova
				<br>
				Site : Walid van Boetzelaer	
		</div>
		<div class="info-trigger"></div>
	</div>

</body>
</html>